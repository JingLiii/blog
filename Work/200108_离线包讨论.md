# 离线包缓存方案 (第一阶段)

## 问题概述

* 最大程度的拜托网络环境对H5小游戏的影响.
* H5游戏项目静态资源较多, 浏览器缓存大小限制

## 具体方案步骤

### 前端打包发布

* 前端静态资源统一压缩打包
* 发布项目, 并指定版本号

### 客户端离线加载/更新示意

* 离线包下载渲染示意图:
* ![客户端加载示意图]()
* 离线包下载(更新)示意图:
* ![离线包下载(更新)示意图]()

### 下载/更新时机

> 不同的流程图

* app控制
  * preload
  * 静默更新
* 项目本身控制
  * 前置
  * 后置

### 更新机制

* 差量包更新

### 清除时机

* 单个项目可灵活设置过期时间, 清理本地文件
* 整体项目根据离线包总大小进行清理早期文件

## 需要暂定问题

* 重复资源, 例如jquery.js, reset.css等, 如何加载(暂定不引入全局包)
* 检查本地离线包, 使用账单问题 (暂定检查本地是否含有文件)
* 是否使用协议方式进行获取, (暂定使用, local)
* 离线包签名机制 (待加入)
* HTML并不包含待展示的数据. (需要提前加载数据, 并进行展示)
* 灰度发布机制. (下载/更新机制过程中, 更新部分用户)
* 强制更新机制. (某限次项目可进行强制更新触发)

* WebView创建时, 网络空等 (提前加载WebView)

* 资源路径控制问题.
* proxy server控制器, 来决定

* 主流程图更改
* admin模块与各个模块之间的关系
* 更新机制不同, download模块运行机制不同?
* 更新机制

## 讲解

* 现状: H5资源在线加载
* 概述: 以项目为力度, 进行web项目的离线缓存
* 方案:

主流程示意图/业务流程图
